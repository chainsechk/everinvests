---
// src/pages/learn/glossary.astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import TelegramCTA from "../../components/TelegramCTA.astro";
import BiasIndicator from "../../components/BiasIndicator.astro";
import { absoluteUrl } from "../../lib/site";

const terms = [
  {
    id: "signal",
    term: "Signal",
    definition: "A directional bias (Bullish, Neutral, or Bearish) generated by our automated analysis. Signals indicate the likely near-term direction of an asset or category.",
    related: ["/guides/bullish-vs-bearish"]
  },
  {
    id: "bias",
    term: "Bias",
    definition: "The directional lean of an asset based on technical indicators. Bullish = likely to rise, Bearish = likely to fall, Neutral = no clear direction.",
    related: ["/guides/bullish-vs-bearish"]
  },
  {
    id: "confluence",
    term: "Confluence",
    definition: "When multiple independent indicators agree on direction. Our system uses 3-indicator confluence: Trend + Volume + Strength. Higher confluence = stronger signal.",
    related: ["/learn/methodology"]
  },
  {
    id: "macro-context",
    term: "Macro Context",
    definition: "The broader market environment that affects all assets. Includes risk sentiment (Risk-On/Risk-Off), VIX volatility, dollar strength (DXY), and geopolitical factors.",
    related: ["/crypto", "/forex", "/stocks"]
  },
  {
    id: "risk-on",
    term: "Risk-On",
    definition: "Market conditions favoring risky assets (stocks, crypto). Characterized by low VIX, weak dollar, and optimistic sentiment. Growth assets tend to outperform.",
    related: ["/crypto"]
  },
  {
    id: "risk-off",
    term: "Risk-Off",
    definition: "Market conditions favoring safe-haven assets (bonds, gold, USD, JPY). Characterized by high VIX, strong dollar, fear in markets. Defensive positioning recommended.",
    related: ["/forex"]
  },
  {
    id: "fear-greed",
    term: "Fear & Greed Index",
    definition: "A 0-100 sentiment indicator for crypto. Extreme Fear (<25) often signals buying opportunities. Extreme Greed (>75) often precedes corrections. We use it as a contrarian signal.",
    related: ["/guides/fear-and-greed", "/crypto"]
  },
  {
    id: "rsi",
    term: "RSI (Relative Strength Index)",
    definition: "A momentum oscillator measuring recent price changes. RSI > 70 = overbought (potential pullback). RSI < 30 = oversold (potential bounce). Used in our Strength indicator.",
    related: ["/stocks", "/learn/methodology"]
  },
  {
    id: "ma20",
    term: "20-Day Moving Average (MA20)",
    definition: "The average price over the last 20 trading days. Price above MA20 = uptrend. Price below MA20 = downtrend. Core component of our Trend indicator.",
    related: ["/learn/methodology"]
  },
  {
    id: "volume",
    term: "Volume",
    definition: "The number of shares/coins traded. High volume confirms price moves (conviction). Low volume suggests weak moves (likely to reverse). Our second independent indicator.",
    related: ["/learn/methodology"]
  },
  {
    id: "funding-rate",
    term: "Funding Rate",
    definition: "In crypto perpetual futures, the rate paid between longs and shorts. Positive = longs pay shorts (crowded long, bearish signal). Negative = shorts pay longs (crowded short, bullish signal).",
    related: ["/crypto"]
  },
  {
    id: "dxy",
    term: "DXY (Dollar Index)",
    definition: "Measures the US Dollar against a basket of currencies. Rising DXY = strong dollar = typically bearish for risk assets. Key forex macro indicator.",
    related: ["/forex"]
  },
  {
    id: "vix",
    term: "VIX (Volatility Index)",
    definition: "The 'fear gauge' measuring expected S&P 500 volatility. VIX > 25 = elevated fear. VIX > 35 = crisis levels. Low VIX = complacency (can precede corrections).",
    related: ["/stocks"]
  },
  {
    id: "yield-curve",
    term: "Yield Curve (2Y-10Y Spread)",
    definition: "The difference between 10-year and 2-year Treasury yields. Inverted (negative) = recession warning. Normal (positive) = healthy economy. Key macro regime indicator.",
    related: ["/learn/methodology"]
  },
  {
    id: "regime",
    term: "Market Regime",
    definition: "The current market phase based on volatility, sentiment, and economic indicators. Regimes include: Normal, Stressed, Crisis, Apathy. Different strategies work in different regimes.",
    related: ["/learn/methodology"]
  }
];

// DefinedTermSet schema for SEO
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "DefinedTermSet",
  name: "EverInvests Trading Glossary",
  description: "Key terms and concepts used in EverInvests market signals",
  hasDefinedTerm: terms.map(t => ({
    "@type": "DefinedTerm",
    name: t.term,
    description: t.definition
  }))
};

const breadcrumbLd = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: [
    { "@type": "ListItem", position: 1, name: "Home", item: absoluteUrl("/") },
    { "@type": "ListItem", position: 2, name: "Learn", item: absoluteUrl("/learn") },
    { "@type": "ListItem", position: 3, name: "Glossary", item: absoluteUrl("/learn/glossary") }
  ]
};
---

<BaseLayout
  title="Trading Glossary - Key Terms Explained"
  description="Understand the key terms used in EverInvests signals: bias, confluence, RSI, Fear & Greed, macro context, and more."
  jsonLd={[jsonLd, breadcrumbLd]}
>
  <Header slot="header" />

  <article class="max-w-3xl mx-auto space-y-10">
    <!-- Header -->
    <header class="text-center py-8" data-animate>
      <nav class="text-sm text-txt-muted mb-4">
        <a href="/" class="hover:text-txt-secondary">Home</a>
        <span class="mx-2">/</span>
        <a href="/learn" class="hover:text-txt-secondary">Learn</a>
        <span class="mx-2">/</span>
        <span class="text-txt-primary">Glossary</span>
      </nav>
      <h1 class="font-display font-bold text-3xl sm:text-4xl text-txt-primary mb-4">
        Trading Glossary
      </h1>
      <p class="text-lg text-txt-secondary max-w-xl mx-auto">
        Key terms and concepts used in our signals. Click any term for the full explanation.
      </p>
    </header>

    <!-- Quick Jump -->
    <section class="card" data-animate>
      <h2 class="font-display font-bold text-lg text-txt-primary mb-3">Jump to Term</h2>
      <div class="flex flex-wrap gap-2">
        {terms.map(t => (
          <a
            href={`#${t.id}`}
            class="px-3 py-1.5 text-sm bg-void-200 hover:bg-void-300 text-txt-secondary hover:text-txt-primary rounded-full transition-colors"
          >
            {t.term}
          </a>
        ))}
      </div>
    </section>

    <!-- Terms List -->
    <section class="space-y-6" data-animate>
      {terms.map(t => (
        <div id={t.id} class="card scroll-mt-24">
          <h3 class="font-display font-bold text-xl text-txt-primary mb-2">
            {t.term}
          </h3>
          <p class="text-txt-secondary mb-4">
            {t.definition}
          </p>
          {t.related && t.related.length > 0 && (
            <div class="flex flex-wrap gap-2">
              {t.related.map(link => (
                <a
                  href={link}
                  class="text-sm text-cyber hover:underline"
                >
                  See in action →
                </a>
              ))}
            </div>
          )}
        </div>
      ))}
    </section>

    <!-- Example: Live Bias -->
    <section class="card border-cyber/20" data-animate>
      <h2 class="font-display font-bold text-lg text-txt-primary mb-4">Example: Bias in Action</h2>
      <p class="text-txt-secondary mb-4">
        Here's what each bias type looks like on our signal pages:
      </p>
      <div class="flex flex-wrap gap-4">
        <div class="flex items-center gap-2">
          <BiasIndicator bias="Bullish" size="md" />
          <span class="text-sm text-txt-muted">Likely to rise</span>
        </div>
        <div class="flex items-center gap-2">
          <BiasIndicator bias="Neutral" size="md" />
          <span class="text-sm text-txt-muted">No clear direction</span>
        </div>
        <div class="flex items-center gap-2">
          <BiasIndicator bias="Bearish" size="md" />
          <span class="text-sm text-txt-muted">Likely to fall</span>
        </div>
      </div>
    </section>

    <!-- CTA: See Signals -->
    <section class="text-center space-y-4" data-animate>
      <p class="text-txt-secondary">
        Now that you know the terms, see them in action:
      </p>
      <div class="flex flex-wrap justify-center gap-3">
        <a href="/crypto" class="btn-primary inline-flex items-center gap-2">
          Crypto Signals
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
          </svg>
        </a>
        <a href="/forex" class="btn-ghost">Forex</a>
        <a href="/stocks" class="btn-ghost">Stocks</a>
      </div>
    </section>

    <!-- Telegram CTA -->
    <TelegramCTA variant="full" />

    <!-- Related Guides -->
    <section class="pt-8 border-t border-divider" data-animate>
      <h3 class="font-display font-bold text-lg text-txt-primary mb-4">Related Guides</h3>
      <div class="grid gap-4 sm:grid-cols-2">
        <a href="/guides/bullish-vs-bearish" class="card hover:border-cyber/40 transition-colors">
          <div class="font-medium text-txt-primary mb-1">Bullish vs Bearish Explained</div>
          <div class="text-sm text-txt-muted">Deep dive into what each bias means.</div>
        </a>
        <a href="/learn/methodology" class="card hover:border-cyber/40 transition-colors">
          <div class="font-medium text-txt-primary mb-1">How We Calculate Signals</div>
          <div class="text-sm text-txt-muted">The 3-indicator confluence model.</div>
        </a>
        <a href="/guides/fear-and-greed" class="card hover:border-cyber/40 transition-colors">
          <div class="font-medium text-txt-primary mb-1">Fear & Greed Index</div>
          <div class="text-sm text-txt-muted">How we use sentiment as a contrarian signal.</div>
        </a>
        <a href="/guides/how-to-use-signals" class="card hover:border-cyber/40 transition-colors">
          <div class="font-medium text-txt-primary mb-1">How to Use These Signals</div>
          <div class="text-sm text-txt-muted">The 3-step workflow: Macro → Category → Asset.</div>
        </a>
      </div>
    </section>
  </article>

  <Footer slot="footer" />
</BaseLayout>
